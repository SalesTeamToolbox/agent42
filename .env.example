# ── Agent42 Configuration ──────────────────────────────────────────────────────

# ── LLM Provider API Keys ────────────────────────────────────────────────────
# OpenRouter — single key, 200+ models, free tier included (recommended)
OPENROUTER_API_KEY=sk-or-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# Direct providers (optional — only needed if you prefer direct API access)
# OPENAI_API_KEY=sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
# ANTHROPIC_API_KEY=sk-ant-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
# DEEPSEEK_API_KEY=sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
# GEMINI_API_KEY=AIzaxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# Local model hosting
# VLLM_API_KEY=not-needed
# VLLM_BASE_URL=http://localhost:8000/v1

# ── Dashboard Auth ────────────────────────────────────────────────────────────
# NOTE: On first run, a setup wizard in the browser will guide you through
# setting a password and generating a secure hash. You can skip editing this
# section if you prefer the wizard.
DASHBOARD_USERNAME=admin

# Option A: Plaintext password (initial setup only — switch to hash for production)
DASHBOARD_PASSWORD=changeme-right-now

# Option B: Bcrypt hash (RECOMMENDED for production)
# Generate: python -c "import bcrypt; print(bcrypt.hashpw(b'yourpassword', bcrypt.gensalt()).decode())"
# DASHBOARD_PASSWORD_HASH=$2b$12$xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# JWT secret — REQUIRED for persistent sessions
# Generate: python -c "import secrets; print(secrets.token_hex(32))"
# If not set, a random secret is generated per-run (sessions lost on restart)
JWT_SECRET=

# ── Dashboard Network ────────────────────────────────────────────────────────
# Host to bind dashboard to (default: 127.0.0.1 — localhost only)
# Set to 0.0.0.0 to expose externally (ensure firewall + auth are configured)
DASHBOARD_HOST=127.0.0.1

# CORS allowed origins (comma-separated). Empty = same-origin only (safest).
# Example: http://localhost:3000,https://yourdomain.com
CORS_ALLOWED_ORIGINS=

# Max login attempts per minute per IP (brute force protection)
LOGIN_RATE_LIMIT=5

# Max concurrent WebSocket connections
MAX_WEBSOCKET_CONNECTIONS=50

# ── Orchestrator ──────────────────────────────────────────────────────────────
# Git repo to create worktrees from (optional — configure via dashboard)
# DEFAULT_REPO_PATH=/home/youruser/projects/myproject

# Max agents running simultaneously (0 = auto: dynamic based on CPU/memory)
MAX_CONCURRENT_AGENTS=0

# Task queue file
TASKS_JSON_PATH=tasks.json

# ── Security ──────────────────────────────────────────────────────────────────
# Enable workspace sandboxing (restricts agent file operations)
SANDBOX_ENABLED=true
WORKSPACE_RESTRICT=true

# Daily API spending limit in USD (0 = unlimited)
MAX_DAILY_API_SPEND_USD=0

# Worktree directory (default: ~/.agent42/worktrees)
# AGENT42_WORKTREE_DIR=/path/to/worktrees

# ── Security Scanning (Automated) ────────────────────────────────────────────
# Scheduled security scans with GitHub issue reporting
SECURITY_SCAN_ENABLED=true
# Scan interval (e.g., 8h = 3x/day, 6h = 4x/day, 12h = 2x/day)
SECURITY_SCAN_INTERVAL=8h
# Minimum severity to include in reports: low, medium, high, critical
SECURITY_SCAN_MIN_SEVERITY=medium
# Create/update GitHub issues with scan findings (requires gh CLI)
SECURITY_SCAN_GITHUB_ISSUES=true

# ── Channels (Phase 2) ───────────────────────────────────────────────────────
# Discord bot — https://discord.com/developers/applications
DISCORD_BOT_TOKEN=
DISCORD_GUILD_IDS=              # Comma-separated guild IDs (empty = all guilds)

# Slack bot — https://api.slack.com/apps (Socket Mode)
SLACK_BOT_TOKEN=xoxb-xxxxxxxxxxxx
SLACK_APP_TOKEN=xapp-xxxxxxxxxxxx

# Telegram bot — https://t.me/BotFather
TELEGRAM_BOT_TOKEN=

# Email (IMAP/SMTP)
EMAIL_IMAP_HOST=imap.gmail.com
EMAIL_IMAP_PORT=993
EMAIL_IMAP_USER=you@gmail.com
EMAIL_IMAP_PASSWORD=your-app-password
EMAIL_SMTP_HOST=smtp.gmail.com
EMAIL_SMTP_PORT=587
EMAIL_SMTP_USER=you@gmail.com
EMAIL_SMTP_PASSWORD=your-app-password

# ── Skills (Phase 3) ─────────────────────────────────────────────────────────
# Extra skill directories (comma-separated, in addition to builtins + repo/skills/)
# SKILLS_DIRS=/path/to/custom/skills,/another/path

# ── Tools (Phase 4) ──────────────────────────────────────────────────────────
# Web search (Brave Search API)
BRAVE_API_KEY=BSAxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# MCP servers config file (JSON format)
# MCP_SERVERS_JSON=mcp_servers.json

# Cron jobs persistence
CRON_JOBS_PATH=cron_jobs.json

# Custom tools directory — drop .py files with Tool subclasses here
# They will be auto-discovered and registered at startup
# CUSTOM_TOOLS_DIR=custom_tools

# ── Dynamic Model Routing ────────────────────────────────────────────────────
# File where dynamic routing rankings are stored
# MODEL_ROUTING_FILE=data/dynamic_routing.json

# How often to sync OpenRouter model catalog (hours)
# MODEL_CATALOG_REFRESH_HOURS=24

# Percentage of tasks to assign unproven models for evaluation (0-100)
# MODEL_TRIAL_PERCENTAGE=10

# Minimum task completions before a model gets ranked
# MODEL_MIN_TRIALS=5

# Enable web benchmark research from authoritative sources
# MODEL_RESEARCH_ENABLED=true

# How often to research benchmarks (hours, 168 = weekly)
# MODEL_RESEARCH_INTERVAL_HOURS=168

# ── Memory (Phase 6) ─────────────────────────────────────────────────────────
MEMORY_DIR=.agent42/memory
SESSIONS_DIR=.agent42/sessions

# Semantic memory (embeddings) — auto-detects from available API keys
# Override with explicit model/provider if needed:
# EMBEDDING_MODEL=text-embedding-3-small
# EMBEDDING_PROVIDER=openai          # openai or openrouter

# ── Qdrant Vector Database (optional — enhances semantic search) ─────
# Server mode: connect to a Qdrant server (Docker or Cloud)
# QDRANT_URL=http://localhost:6333
# QDRANT_API_KEY=                    # Required for Qdrant Cloud
# QDRANT_COLLECTION_PREFIX=agent42   # Prefix for collection names
#
# Embedded mode: local file storage (no server needed)
# Set QDRANT_ENABLED=true without QDRANT_URL to use embedded mode
# QDRANT_ENABLED=true
# QDRANT_LOCAL_PATH=.agent42/qdrant  # Path for embedded Qdrant storage
#
# Docker quickstart:
#   docker run -p 6333:6333 qdrant/qdrant
#   pip install qdrant-client

# ── Redis (optional — fast session cache + embedding cache) ──────────
# REDIS_URL=redis://localhost:6379/0
# REDIS_PASSWORD=
# SESSION_TTL_DAYS=7                 # Auto-expire old sessions
# EMBEDDING_CACHE_TTL_HOURS=24       # Cache embedding API responses
#
# Docker quickstart:
#   docker run -p 6379:6379 redis:alpine
#   pip install redis[hiredis]

# ── SSH Remote Shell ────────────────────────────────────────────────────
# Enable SSH tool for remote server management (disabled by default)
SSH_ENABLED=false
# Allowed host patterns (comma-separated, e.g., "*.mycompany.com,192.168.1.*")
# Empty = all hosts allowed (approval gate still required)
# SSH_ALLOWED_HOSTS=
# Default SSH private key path
# SSH_DEFAULT_KEY_PATH=~/.ssh/id_rsa
# Max file transfer size in MB (upload/download)
SSH_MAX_UPLOAD_MB=50
# Per-command execution timeout in seconds
SSH_COMMAND_TIMEOUT=120

# ── Tunnel Manager ──────────────────────────────────────────────────────
# Expose local services to the internet for testing/preview
TUNNEL_ENABLED=false
# Provider: auto (detect best), cloudflared, serveo, localhost.run
TUNNEL_PROVIDER=auto
# Allowed ports for tunneling (comma-separated, empty = all ports)
# TUNNEL_ALLOWED_PORTS=8000,3000,80,443
# Auto-shutdown tunnels after N minutes
TUNNEL_TTL_MINUTES=60

# ── Knowledge Base / RAG ────────────────────────────────────────────────
# Document import directory
KNOWLEDGE_DIR=.agent42/knowledge
# Chunking parameters (tokens)
KNOWLEDGE_CHUNK_SIZE=500
KNOWLEDGE_CHUNK_OVERLAP=50
# Max search results per query
KNOWLEDGE_MAX_RESULTS=10

# ── Vision / Image Analysis ─────────────────────────────────────────────
# Max image file size in MB
VISION_MAX_IMAGE_MB=10
# Override vision model (empty = auto-detect from available API keys)
# VISION_MODEL=gpt-4o-mini

# ── Apps Platform ──────────────────────────────────────────────────────
# Enable the apps platform (build and serve user applications)
APPS_ENABLED=true
# Base directory for all apps
APPS_DIR=apps
# Dynamic port range for running apps
APPS_PORT_RANGE_START=9100
APPS_PORT_RANGE_END=9199
# Max number of simultaneously running apps
APPS_MAX_RUNNING=5
# Automatically restart crashed apps
APPS_AUTO_RESTART=true
# Seconds between background health-check polls for running apps
APPS_MONITOR_INTERVAL=15
# Default runtime for new apps (static, python, node, docker)
APPS_DEFAULT_RUNTIME=python
# Enable git version control for new apps by default
APPS_GIT_ENABLED_DEFAULT=false
# GitHub Personal Access Token for app repo creation and push (optional)
# Create at: https://github.com/settings/tokens (repo scope)
APPS_GITHUB_TOKEN=
# Default app mode for new apps ("internal" = Agent42 system tool, "external" = public release)
APPS_DEFAULT_MODE=internal
# Require dashboard auth by default for new apps' proxy access
APPS_REQUIRE_AUTH_DEFAULT=false
